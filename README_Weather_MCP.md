# å¤©æ°”æŸ¥è¯¢MCPæœåŠ¡

ä¸€ä¸ªåŸºäºPythonå®ç°çš„å¤©æ°”æŸ¥è¯¢MCPï¼ˆModel Context Protocolï¼‰æœåŠ¡ï¼Œæ”¯æŒå®æ—¶å¤©æ°”ä¿¡æ¯æŸ¥è¯¢å’Œå¤©æ°”é¢„æŠ¥åŠŸèƒ½ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

- **å®æ—¶å¤©æ°”æŸ¥è¯¢**: è·å–æŒ‡å®šåŸå¸‚çš„å½“å‰å¤©æ°”ä¿¡æ¯
- **å¤©æ°”é¢„æŠ¥**: æŸ¥è¯¢æœªæ¥1-5å¤©çš„å¤©æ°”é¢„æŠ¥
- **å¤šè¯­è¨€æ”¯æŒ**: æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡åŸå¸‚åç§°
- **æ¨¡æ‹Ÿæ•°æ®**: å½“APIä¸å¯ç”¨æ—¶æä¾›æ¨¡æ‹Ÿå¤©æ°”æ•°æ®
- **MCPåè®®å…¼å®¹**: å®Œå…¨ç¬¦åˆMCP 2024-11-05åè®®è§„èŒƒ

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Python 3.7+
- aiohttpåº“
- asyncioæ”¯æŒ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. é…ç½®APIå¯†é’¥ï¼ˆå¯é€‰ï¼‰

ç¼–è¾‘ `config.json` æ–‡ä»¶ï¼Œæ·»åŠ æ‚¨çš„OpenWeatherMap APIå¯†é’¥ï¼š

```json
{
  "weather_api": {
    "api_key": "your_openweathermap_api_key_here"
  }
}
```

> æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰APIå¯†é’¥ï¼ŒæœåŠ¡å°†ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®è¿›è¡Œæ¼”ç¤ºã€‚

### 3. å¯åŠ¨MCPæœåŠ¡å™¨

```bash
python weather_mcp_server.py
```

### 4. è¿è¡Œæµ‹è¯•å®¢æˆ·ç«¯

**äº¤äº’å¼æ¨¡å¼ï¼š**
```bash
python test_weather_mcp.py
```

**è‡ªåŠ¨æ¼”ç¤ºæ¨¡å¼ï¼š**
```bash
python test_weather_mcp.py --auto
```

## ğŸ”§ MCPå·¥å…·è¯´æ˜

### get_weather

è·å–æŒ‡å®šåŸå¸‚çš„å½“å‰å¤©æ°”ä¿¡æ¯ã€‚

**å‚æ•°ï¼š**
- `city` (å¿…éœ€): åŸå¸‚åç§°ï¼ˆä¸­æ–‡æˆ–è‹±æ–‡ï¼‰
- `country_code` (å¯é€‰): å›½å®¶ä»£ç ï¼ˆå¦‚CNã€USç­‰ï¼‰

**ç¤ºä¾‹ï¼š**
```json
{
  "name": "get_weather",
  "arguments": {
    "city": "åŒ—äº¬",
    "country_code": "CN"
  }
}
```

### get_weather_forecast

è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”é¢„æŠ¥ã€‚

**å‚æ•°ï¼š**
- `city` (å¿…éœ€): åŸå¸‚åç§°
- `days` (å¯é€‰): é¢„æŠ¥å¤©æ•°ï¼ˆ1-5å¤©ï¼Œé»˜è®¤3å¤©ï¼‰

**ç¤ºä¾‹ï¼š**
```json
{
  "name": "get_weather_forecast",
  "arguments": {
    "city": "ä¸Šæµ·",
    "days": 5
  }
}
```

## ğŸ“Š è¿”å›æ•°æ®æ ¼å¼

### å¤©æ°”ä¿¡æ¯åŒ…å«ï¼š

- ğŸŒ¡ï¸ **æ¸©åº¦**: å½“å‰æ¸©åº¦å’Œä½“æ„Ÿæ¸©åº¦
- â˜ï¸ **å¤©æ°”æè¿°**: å¤©æ°”çŠ¶å†µæè¿°
- ğŸ’§ **æ¹¿åº¦**: ç›¸å¯¹æ¹¿åº¦ç™¾åˆ†æ¯”
- ğŸ’¨ **é£é€Ÿ**: é£é€Ÿï¼ˆç±³/ç§’ï¼‰
- ğŸ”½ **æ°”å‹**: å¤§æ°”å‹å¼ºï¼ˆç™¾å¸•ï¼‰
- ğŸ• **æ›´æ–°æ—¶é—´**: æ•°æ®æ›´æ–°æ—¶é—´æˆ³

### ç¤ºä¾‹è¾“å‡ºï¼š

```
ğŸŒ¤ï¸ åŒ—äº¬ å½“å‰å¤©æ°”

ğŸŒ¡ï¸ æ¸©åº¦: 15Â°C (ä½“æ„Ÿæ¸©åº¦: 13Â°C)
â˜ï¸ å¤©æ°”: æ™´æœ—
ğŸ’§ æ¹¿åº¦: 65%
ğŸ’¨ é£é€Ÿ: 3.2 m/s
ğŸ”½ æ°”å‹: 1013 hPa
ğŸ• æ›´æ–°æ—¶é—´: 2024-05-30 14:30:25
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
weather-mcp/
â”œâ”€â”€ weather_mcp_server.py    # MCPæœåŠ¡å™¨ä¸»ç¨‹åº
â”œâ”€â”€ test_weather_mcp.py      # æµ‹è¯•å®¢æˆ·ç«¯
â”œâ”€â”€ config.json              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt         # Pythonä¾èµ–
â””â”€â”€ README_Weather_MCP.md    # é¡¹ç›®æ–‡æ¡£
```

## ğŸ”Œ MCPåè®®é›†æˆ

### åˆå§‹åŒ–è¿æ¥

```json
{
  "jsonrpc": "2.0",
  "id": "1",
  "method": "initialize",
  "params": {
    "protocolVersion": "2024-11-05",
    "capabilities": {},
    "clientInfo": {
      "name": "weather-client",
      "version": "1.0.0"
    }
  }
}
```

### è·å–å·¥å…·åˆ—è¡¨

```json
{
  "jsonrpc": "2.0",
  "id": "2",
  "method": "tools/list"
}
```

### è°ƒç”¨å·¥å…·

```json
{
  "jsonrpc": "2.0",
  "id": "3",
  "method": "tools/call",
  "params": {
    "name": "get_weather",
    "arguments": {
      "city": "åŒ—äº¬"
    }
  }
}
```

## ğŸ› ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹æ¨¡æ‹Ÿæ•°æ®

ç¼–è¾‘ `config.json` ä¸­çš„ `mock_data` éƒ¨åˆ†æ¥è‡ªå®šä¹‰æ¨¡æ‹Ÿå¤©æ°”æ•°æ®ï¼š

```json
{
  "mock_data": {
    "cities": {
      "ä½ çš„åŸå¸‚": {"temp": 20, "desc": "æ™´æœ—"}
    }
  }
}
```

### æ·»åŠ æ–°çš„å¤©æ°”æ•°æ®æº

åœ¨ `WeatherMCPServer` ç±»ä¸­æ·»åŠ æ–°çš„æ•°æ®æºæ”¯æŒï¼š

```python
async def get_weather_from_custom_api(self, city: str):
    # å®ç°è‡ªå®šä¹‰APIè°ƒç”¨
    pass
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **APIå¯†é’¥æ— æ•ˆ**
   - æ£€æŸ¥ `config.json` ä¸­çš„APIå¯†é’¥æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤APIå¯†é’¥æœ‰æ•ˆä¸”æœªè¿‡æœŸ

2. **ç½‘ç»œè¿æ¥é—®é¢˜**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤é˜²ç«å¢™è®¾ç½®å…è®¸HTTPè¯·æ±‚

3. **ä¾èµ–å®‰è£…å¤±è´¥**
   - ä½¿ç”¨ `pip install --upgrade pip` æ›´æ–°pip
   - å°è¯•ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒå®‰è£…ä¾èµ–

### è°ƒè¯•æ¨¡å¼

å¯ç”¨è¯¦ç»†æ—¥å¿—è¾“å‡ºï¼š

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/new-feature`)
3. æäº¤æ›´æ”¹ (`git commit -am 'Add new feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/new-feature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [OpenWeatherMap API](https://openweathermap.org/api) - å¤©æ°”æ•°æ®æä¾›
- [MCP Protocol](https://modelcontextprotocol.io/) - åè®®è§„èŒƒ
- [aiohttp](https://aiohttp.readthedocs.io/) - å¼‚æ­¥HTTPå®¢æˆ·ç«¯

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- åˆ›å»º [Issue](https://github.com/your-repo/weather-mcp/issues)
- å‘é€é‚®ä»¶è‡³ï¼šyour-email@example.com

---

**äº«å—ä½¿ç”¨å¤©æ°”æŸ¥è¯¢MCPæœåŠ¡ï¼** ğŸŒ¤ï¸